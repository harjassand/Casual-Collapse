env:
  type: object
  num_objects: 3
  obs_mode: structured
  image_size: 32
  spurious_noise: 0.1
  dt: 0.1
  spurious_flip_on_odd: true
  prediction: label_ce
  train_env_ids:
  - 0
  - 2
  test_env_ids:
  - 1
  - 3
  all_env_ids:
  - 0
  - 1
  - 2
  - 3
  interventions:
  - set_pos:
      obj: 0
      value:
      - 0.5
      - 0.5
    duration: 1
  - set_background: 1.0
    duration: 1
model:
  input_type: structured
  obs_dim: 6
  num_slots: 3
  slot_dim: 16
  num_codes: 16
  repr_mode: continuous_only
  label_dim: 2
  use_quantizer: true
  commitment_weight: 0.25
  vq_decay: 0.99
  vq_use_ema: false
  vq_soft_temp: 1.0
  use_graph: false
  graph_hidden: 64
  use_residual: true
  residual_dim: 16
  action_dim: 2
  dyn_hidden: 128
  recon: false
  use_logic: false
  logic_predicates: []
  logic_constraints: []
train:
  num_steps: 2000
  batch_size: 64
  lr: 0.001
  buffer_size: 5000
  horizon: 3
  log_interval: 50
  checkpoint_interval: 500
  run_dir: runs/diagnostics/object/repr_continuous_only
  operator_interval: 200
  perplexity_threshold: 2.0
  active_code_threshold: 0.01
  stats_max_per_code: 256
  num_future_classes: 4
  pred_plateau_window: 50
  pred_plateau_threshold: 0.0001
  degenerate_entropy_threshold: 0.1
  degenerate_pred_threshold: 0.5
  enable_operator: true
  dead_code_threshold: 0.01
  dead_code_patience: 0
loss:
  beta: 1.0
  gamma: 1.0
  lambda: 1.0
  mu: 0.0
  nu: 0.0
  prediction: mse
  use_rex: true
  use_irm: false
  modularity: none
  vq_entropy_reg: 0.0
policy:
  type: random
  action_scale: 0.1
  ensemble_size: 1
eval:
  ckpt_path: runs/default/model_1500.pt
  output_path: runs/default/eval_metrics.json
  steps: 200
  active_code_threshold: 0.01
  save_rollouts: false
  rollouts_path: runs/default/rollouts.npz
  eval_seed: 123
  interventions: []
  alignment_samples: 200
  alignment_rollouts: 20
  alignment_clusters: 4
  alignment_seed: 123
  one_shot_lr: 0.01
operator:
  delta_merge: 0.05
  delta_merge_inv: 0.05
  delta_split: 0.7
  eps_split_gain: 0.01
vq:
  entropy_reg: 0.1
  dead_code_reinit:
    enabled: true
    min_usage: 0.01
    window_steps: 20
    strategy: sample_encoder
preset:
  train:
    num_steps: 300
    checkpoint_interval: 100
    log_interval: 50
    buffer_size: 500
    batch_size: 32
    horizon: 2
  eval:
    steps: 30
    alignment_samples: 50
    alignment_rollouts: 5
seed: 0
device: auto
